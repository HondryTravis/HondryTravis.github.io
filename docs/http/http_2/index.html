<!doctype html>
<html class="docs-version-current" lang="zh-Hans" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="TRAVIS RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="TRAVIS Atom Feed"><title data-react-helmet="true">HTTP 2/3 &amp; HTTPS | TRAVIS</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://hondrytravis.github.io//docs/http/http_2"><meta data-react-helmet="true" name="docusaurus_locale" content="zh-Hans"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="HTTP 2/3 &amp; HTTPS | TRAVIS"><meta data-react-helmet="true" name="description" content="密码学"><meta data-react-helmet="true" property="og:description" content="密码学"><link data-react-helmet="true" rel="shortcut icon" href="/images/default/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://hondrytravis.github.io//docs/http/http_2"><link data-react-helmet="true" rel="alternate" href="https://hondrytravis.github.io//docs/http/http_2" hreflang="zh-Hans"><link data-react-helmet="true" rel="alternate" href="https://hondrytravis.github.io//docs/http/http_2" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.673bc2ec.css">
<link rel="preload" href="/assets/js/runtime~main.261a0b30.js" as="script">
<link rel="preload" href="/assets/js/main.d8aec2c2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">跳到主要内容</a></div><nav class="navbar navbar--fixed-top navbar--dark navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/default/Logo.png" alt="logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/images/default/Logo.png" alt="logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">Better Late Than Never</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">博客</a><a class="navbar__item navbar__link" href="/algorithm/">算法</a><a class="navbar__item navbar__link" href="/open_source/"> 开源贡献</a><a class="navbar__item navbar__link" href="/blog">阅读</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/HondryTravis" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">🌜</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">🌞</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo sidebarWithHideableNavbar_267A"><a tabindex="-1" class="sidebarLogo_3h0W" href="/"><img src="/images/default/Logo.png" alt="logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/images/default/Logo.png" alt="logo" class="themedImage_1VuW themedImage--dark_hz6m"><b>Better Late Than Never</b></a><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">博客</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Typescript</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Wasm</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">HTML | CSS</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Webpack</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Node</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">前端工程化</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">性能优化</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Framework</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">OS</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Linux</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">编程思想</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">HTTP</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/http/http_1">HTTP 1.x</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/http/http_2">HTTP 2/3 &amp; HTTPS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/http/tcp">TCP 协议</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/http/cdn">CDN</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Nginx</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Java</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Python</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">数据库</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">其他常用工具</a></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>HTTP 2/3 &amp; HTTPS</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="密码学">密码学<a aria-hidden="true" class="hash-link" href="#密码学" title="标题的直接链接">​</a></h2><p>密码学的处理对象是数字和字符串</p><p>散列是一种数据一旦转换为其他形式将永远无法恢复的加密技术</p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="加密分类">加密分类<a aria-hidden="true" class="hash-link" href="#加密分类" title="标题的直接链接">​</a></h3><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>加密</h5></div><div class="admonition-content"><p>对称加密（AES、DES、3DES）</p><p>非对称加密（RSA）</p></div></div><p><img alt="加密" src="/assets/images/encryption-f867086fdf0dc7e2bab12a6b357b8546.png"></p><p>解密</p><p><img alt="解密" src="/assets/images/decryption-3c681620d5f4282d0b5bff3c0ffe93f1.png"></p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="密钥交换算法">密钥交换算法<a aria-hidden="true" class="hash-link" href="#密钥交换算法" title="标题的直接链接">​</a></h3><p><strong>Diffie-Hellman</strong> 算法是一种著名的密钥协商算法，这种算法可以使得信息交换的双方通过公开的非安
全的网络协商生成安全的共享密钥。</p><ol><li>Alice与Bob确定两个大素数n和g，这两个数不用保密</li><li>Alice选择另一个大随机数x，并计算A如下：A=gx mod n</li><li>Alice将A发给Bob</li><li>Bob选择另一个大随机数y，并计算B如下：B=gy mod n</li><li>Bob将B发给Alice</li><li>计算秘密密钥K1如下：K1=Bx mod n</li><li>计算秘密密钥K2如下：K2=Ay mod n</li></ol><p>K1=K2，因此Alice和Bob可以用其进行加解密</p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="https-协议分析">HTTPS 协议分析<a aria-hidden="true" class="hash-link" href="#https-协议分析" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="https-加密方式">https 加密方式<a aria-hidden="true" class="hash-link" href="#https-加密方式" title="标题的直接链接">​</a></h3><p>https 加密方式涉及到密钥交换</p><p>一般的证书都是三级;第一级是根证书签发机构(CA), 第二级是二级签发机构,到最后才是证书;
根证书是内置到操作系统和浏览器里面的</p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="证书签发机构ca">证书签发机构(CA)<a aria-hidden="true" class="hash-link" href="#证书签发机构ca" title="标题的直接链接">​</a></h3><p>通过CA发放的证书完成密钥的交换，实际上是利用 <strong>非对称的加密</strong> 算法完成数据加密密钥的安全交换，然后再利用 <strong>数据加密密钥</strong> 完成数据的安全交换。</p><p>数字证书：数字证书是互联网通信中标识双方身份信息的数字文件，由CA签发。</p><p>CA：CA（certification authority）是数字证书的签发机构。作为权威机构，其审核申请者身份后签发数字证书，这样我们只需要校验数字证书即可确定对方的真实身份。</p><h4 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="ca的工作流程">CA的工作流程<a aria-hidden="true" class="hash-link" href="#ca的工作流程" title="标题的直接链接">​</a></h4><ol><li><p>服务器 example.com将从CA请求TLS证书，例如 Digicert</p></li><li><p>Digicert将为example.com创建证书，证书将包含必要的数据，例如服务器名称，服务器的公钥等</p></li><li><p>Digicert将创建数据（证书）的哈希值，并使用自己的私钥对其进行加密</p></li><li><p>浏览器和操作系统自带Digicert等权威机构的公钥</p></li><li><p>当浏览器收到签名证书时，它将使用公钥从签名生成哈希值，它还将使用证书中指定的散列算法生成数据（证书）的散列，如果两个哈希值匹配，则名验证成功并且证书是可信的</p></li><li><p>现在浏览器可以使用证书中指定的example.com的公钥继续进行身份验证过程。</p></li></ol><p><strong>在这里，我们可以将Digicert称为 Root CA.</strong></p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="浏览器如何验证服务器证书的有效性">浏览器如何验证服务器证书的有效性<a aria-hidden="true" class="hash-link" href="#浏览器如何验证服务器证书的有效性" title="标题的直接链接">​</a></h3><p><img alt="identity_CA" src="/assets/images/identity_CA-0157d5558879ee5efefad117cccc8b7b.png"></p><p>证书颁发机构是为服务器创建并签署证书，很少有组织从事这项工作，即Digicert，Geotrust，Comodo等。如果他们正在为所有服务器签署证书，则必须为所有签名使用相同的私钥，如果它被盗，那么所有的信任都会丢失。为了解决这个问题并增加更多的平均信息量，引入了中间CA(intermediate CA)的概念</p><p>服务器使用中级证书颁发机构的签名，因此，在与浏览器通信时，服务器将共享两个证书：</p><ol><li><p>包含服务器的公钥，即实际的服务器证书；</p></li><li><p>由 Root CA 颁发的 intermediate CA 证书。</p></li></ol><p>在签名验证期间，浏览器首先使用已经存储在浏览器中的Root CA的公钥来验证中间证书的数字签名，如果成功，浏览器现在可以信任中间证书及其公钥。现在使用此公钥，浏览器将验证原始服务器证书的签名，该组织可以注册为intermediate CA，以便为其域签署证书</p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="ssltls协议">SSL/TLS协议<a aria-hidden="true" class="hash-link" href="#ssltls协议" title="标题的直接链接">​</a></h3><p><img alt="SSL/TLS" src="/assets/images/ssl_tls-23421a14141893b9d86bcc1f52728cf6.png"></p><p>传输层安全性协议（Transport Layer Security - TLS），及其前身安全套接层（Secure Sockets Layer - SSL）是一种安全协议，目的是为互联网通信提供安全及数据完整性保障</p><p>HTTPS协议的安全性由SSL协议实现，当前使用的TLS协议 1.2 版本包含了四个核心子协议：握手协议、密钥配置切换协议、应用数据协议及报警协议</p><ul><li>TLS适用于对称密钥</li><li>对称密钥可以通过安全密钥交换算法共享</li><li>如果请求被截获，密钥交换可能会被欺骗</li><li>使用数字签名进行身份验证</li><li>证书颁发机构和信任链</li></ul><p>HTTPS协议、SSL协议、TLS协议、握手协议的关系</p><ul><li>HTTPS是Hypertext Transfer Protocol over Secure Socket Layer的缩写，即HTTP over SSL，可理解为基于SSL的HTTP协议。HTTPS协议安全是由SSL协议实现的</li><li>SSL协议是一种记录协议，扩展性良好，可以很方便的添加子协议</li><li>握手协议是SSL协议的一个子协议</li><li>TLS协议是SSL协议的后续版本，本文中涉及的SSL协议默认是TLS协议1.2版本</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="https-ssltls-分析">HTTPS SSL/TLS 分析<a aria-hidden="true" class="hash-link" href="#https-ssltls-分析" title="标题的直接链接">​</a></h3><p>TLS 握手的步骤：</p><ol><li>ClientHello：客户端发送所支持的 SSL/TLS 最高协议版本号和所支持的加密算法集合及压缩方法集合等信息给服务器端</li><li>ServerHello：服务器端收到客户端信息后，选定双方都能够支持的 SSL/TLS 协议版本和加密方法及压缩方法，返回给客户端</li><li>SendCertificate（可选）：服务器端发送服务端证书给客户端</li><li>RequestCertificate（可选）：如果选择双向验证，服务器端向客户端请求客户端证书</li><li>ServerHelloDone：服务器端通知客户端初始协商结束</li><li>ResponseCertificate（可选）：如果选择双向验证，客户端向服务器端发送客户端证书</li><li>ClientKeyExchange：客户端使用服务器端的公钥，对客户端公钥和密钥种子进行加密，再发送给服务器端</li><li>CertificateVerify（可选）：如果选择双向验证，客户端用本地私钥生成数字签名，并发送给服务器端，让其通过收到的客户端公钥进行身份验证</li><li>CreateSecretKey：通讯双方基于密钥种子等信息生成通讯密钥</li><li>ChangeCipherSpec：客户端通知服务器端已将通讯方式切换到加密模式</li><li>Finished：客户端做好加密通讯的准备</li><li>ChangeCipherSpec：服务器端通知客户端已将通讯方式切换到加密模式</li><li>Finished：服务器做好加密通讯的准备</li><li>Encrypted/DecryptedData：双方使用客户端密钥，通过对称加密算法对通讯内容进行加密</li><li>ClosedConnection：通讯结束后，任何一方发出断开 SSL 连接的消息</li></ol><p><img alt="https" src="/assets/images/https-e9dd5abb98a0fbb054be7e987557fc79.png"></p><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="http-2协议分析">HTTP 2协议分析<a aria-hidden="true" class="hash-link" href="#http-2协议分析" title="标题的直接链接">​</a></h2><p>HTTP/2 没有改动 HTTP 的应用语义。 HTTP 方法、状态代码、URI 和标头字段等核心概念一如往常</p><p>HTTP/2 修改了数据格式化（分帧）以及在客户端与服务器间传输的方式。这两点统帅全局，通过新的分帧层向我们的应用隐藏了所有复杂性</p><p>由于HTTP/2 引入了一个新的二进制分帧层，该层无法与之前的 HTTP/1.x 服务器和客户端向后兼容，因此协议的主版本提升到 HTTP/2</p><p><img alt="http2" src="/assets/images/http2-119e759191dfd69e14fe9fe628077e86.png"></p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="特点">特点<a aria-hidden="true" class="hash-link" href="#特点" title="标题的直接链接">​</a></h3><ol><li>使用二进制格式传输，更高效、更紧凑</li><li>对报头压缩，降低开销</li><li>多路复用，一个网络连接实现并行请求</li><li>服务器主动推送，减少请求的延迟</li><li>默认使用加密</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="二进制分帧层">二进制分帧层<a aria-hidden="true" class="hash-link" href="#二进制分帧层" title="标题的直接链接">​</a></h3><p>HTTP/2 所有性能增强的核心在于新的二进制分帧层，它定义了如何封装 HTTP 消息并在客户端与服务器之间传输</p><p>这里所谓的“层”指的是位于套接字接口与应用可见的高级 HTTP API 之间一个经过优化的新编码机制</p><p>HTTP/1.x 协议以换行符作为纯文本的分隔符，而HTTP/2 将所有传输的信息分割为更小的消息和帧，并采用二进制格式对它们编码</p><p>客户端和服务器会替我们完成必要的分帧工作</p><p><img alt="http2" src="/assets/images/http2_binary-f35023fde0a30249f6c95f9eafc25e7a.png"></p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="多路复用">多路复用<a aria-hidden="true" class="hash-link" href="#多路复用" title="标题的直接链接">​</a></h3><p>在 HTTP/1.x 中，如果客户端要想发起多个并行请求以提升性能，则必须使用多个 TCP 连接。这种模型也会导致队首阻塞，从而造成底层 TCP 连接的效率低下</p><p><img alt="http2" src="/assets/images/http2_connect-10d2a90e24da4d4321f9c4c033ccd388.png"></p><p>将 HTTP 消息分解为独立的帧，交错发送，然后在另一端重新组装是 HTTP 2 最重要的一项增强。这个机制会在整个网络技术栈中引发一系列连锁反
应，从而带来巨大的性能提升</p><p><img alt="http2" src="/assets/images/http2_tcp_connect-dcc05666996a4ee19256e09b8672042a.png"></p><ol><li>并行交错地发送多个请求，请求之间互不影响</li><li>并行交错地发送多个响应，响应之间互不干扰</li><li>使用一个连接并行发送多个请求和响应</li><li>不必再为绕过 HTTP/1.x 限制而做很多工作</li><li>消除不必要的延迟和提高现有网络容量的利用率，从而减少页面加载时间</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="服务器推送">服务器推送<a aria-hidden="true" class="hash-link" href="#服务器推送" title="标题的直接链接">​</a></h3><p>HTTP/2 新增的另一个强大的新功能是，服务器可以对一个客户端请求发送多个响应。 换句话说，除了对最初请求的响应外，服务器还可以向客户端推送额外资源，而无需客户端明确地请求</p><p>HTTP/2 打破了严格的请求-响应语义，支持一对多和服务器发起的推送工作流服务器已经知道客户端下一步要请求什么资源，这时候服务器推送即可派上用场
<img alt="http2" src="/assets/images/http2_server-a299db95b46532cf84d32f8961e593ed.png"></p><p>推送资源可以进行以下处理</p><ul><li>由客户端缓存</li><li>在不同页面之间重用</li><li>与其他资源一起复用</li><li>由服务器设定优先级</li><li>被客户端拒绝</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="伪头字段">伪头字段<a aria-hidden="true" class="hash-link" href="#伪头字段" title="标题的直接链接">​</a></h3><p>伪头部字段是http2内置的几个特殊的以”:”开始的key，用于替代HTTP/1.x中请求行/响应行中的信息，比如请求方法，响应状态码等</p><table><thead><tr><th align="center">方法</th><th align="center">概述</th><th align="center">请求/响应</th></tr></thead><tbody><tr><td align="center">:method</td><td align="center">目标URL模式部分</td><td align="center">请求</td></tr><tr><td align="center">:scheme</td><td align="center">目标URL模式部分</td><td align="center">请求</td></tr><tr><td align="center">:authority</td><td align="center">目标RUL认证部分</td><td align="center">请求</td></tr><tr><td align="center">:path</td><td align="center">目标URL的路径和查询部分（绝对路径产生式和一个跟着&quot;？&quot;字符的查询产生式）。</td><td align="center">请求</td></tr><tr><td align="center">:status</td><td align="center">响应头中的HTTP状态码部分</td><td align="center">响应</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="了解http-3">了解HTTP 3<a aria-hidden="true" class="hash-link" href="#了解http-3" title="标题的直接链接">​</a></h2><p>Google 自己做的</p><p>运行在 QUIC 之上的 HTTP 协议被称为 HTTP/3（HTTP-over-QUIC）</p><p>QUIC 协议（Quick UDP Internet Connection）基于 UDP，正是看中了UDP 的速度与效率。同时 QUIC 也整合了 TCP、TLS 和 HTTP/2 的优点，并加以优化</p><p><img alt="http3" src="/assets/images/http3-02fff5e5a0330aa26a3036a53113cc66.png"></p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="http-3特点">HTTP 3特点<a aria-hidden="true" class="hash-link" href="#http-3特点" title="标题的直接链接">​</a></h3><ul><li>减少了握手的延迟（1-RTT 或 0-RTT）</li><li>多路复用，并且没有 TCP 的阻塞问题</li><li>连接迁移，（主要是在客户端）当由 Wifi 转移到 4G 时，连接不会被断开</li></ul><p>HTTP 3与HTTP 1.1和HTTP 2没有直接的关系，也不是http2的扩展</p><p>HTTP 3将会是一个全新的WEB协议</p><p>HTTP 3目前处于制订和测试阶段</p><p><a href="https://www.chromium.org/quic" target="_blank" rel="noopener noreferrer">https://www.chromium.org/quic</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="队首阻塞问题">队首阻塞问题<a aria-hidden="true" class="hash-link" href="#队首阻塞问题" title="标题的直接链接">​</a></h3><p>HTTP/1.1 和 HTTP/2 都存在队头阻塞问题（Head of line blocking）</p><p>HTTP/1.1 的队头阻塞。一个 TCP 连接同时传输 10 个请求，其中第 1、2、3 个请求已被客户端接收，但第 4 个请求丢失，那么后面第 5 - 10 个请求都被阻塞，需要等第 4 个请求处理完毕才能被处理，这样就浪费了带宽资源</p><p><img alt="http1" src="/assets/images/http1_block-2b0d469abc6282465e22834c94636fd7.png"></p><p>HTTP/2 的多路复用虽然可以解决“请求”这个粒度的阻塞，但 HTTP/2 的基础 TCP 协议本身却也存在着队头阻塞的问题</p><p>由于 HTTP/2 必须使用 HTTPS，而 HTTPS 使用的 TLS 协议也存在队头阻塞问题</p><p>队头阻塞会导致 HTTP/2 在更容易丢包的弱网络环境下比 HTTP/1.1 更慢</p><p><img alt="http2" src="/assets/images/http2_block-764d4f205d6c9370707362b4ce95d401.png"></p><p><strong>那 QUIC 解决队头阻塞问题的的方法</strong>:</p><p><img alt="http3" src="/assets/images/http3_block-29c0762e92f36a5d03a9ff9c5e630cf3.png"></p><ul><li>QUIC 的传输单元是 Packet，加密单元也是 Packet，整个加密、传输、解密都基于 Packet，这样就能避免 TLS 的队头阻塞问题</li><li>QUIC 基于 UDP，UDP 的数据包在接收端没有处理顺序，即使中间丢失一个包，也不会阻塞整条连接，其他的资源会被正常处理</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="http与代理">HTTP与代理<a aria-hidden="true" class="hash-link" href="#http与代理" title="标题的直接链接">​</a></h2><p><img alt="http3" src="/assets/images/http_proxy-250231a05e0a92bd394aaa428c61f5a6.png"></p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="正向代理">正向代理<a aria-hidden="true" class="hash-link" href="#正向代理" title="标题的直接链接">​</a></h3><p>正向代理代理一般是指代理客户端，为客户端收发请求，使真实客户端对服务器不可见</p><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="反向代理">反向代理<a aria-hidden="true" class="hash-link" href="#反向代理" title="标题的直接链接">​</a></h3><p>反向代理是代理服务器端，为服务器收发请求，使真实服务器对客户端不可见</p><h4 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="反向代理的用途">反向代理的用途<a aria-hidden="true" class="hash-link" href="#反向代理的用途" title="标题的直接链接">​</a></h4><ul><li>加密和SSL加速</li><li>负载均衡</li><li>缓存静态内容</li><li>压缩</li><li>减速上传</li><li>安全</li><li>外网发布</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_3R7-" id="反向代理做负载均衡">反向代理做负载均衡<a aria-hidden="true" class="hash-link" href="#反向代理做负载均衡" title="标题的直接链接">​</a></h3><p>反向代理服务器位于用户与目标服务器之间，但是对于用户而言，反向代理服务器就相当于目标服务器，即用户直接访问反向代理服务器就可以获得目标服务器的资源。同时，用户不需要知道目标服务器的地址，也无须在用户端作任何设定。反向代理服务器通常可用来作为Web加速，即使用反向代理作为Web服务器的前置机来降低网络和服务器的负载，提高访问效率;</p><p><img alt="http3" src="/assets/images/proxy_1-416e575e3a462b8e3d21c58f05d6bb1f.png"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/HondryTravis/Blog/tree/master/packages/docs/http/http_2.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">最后<!-- -->由 <b>travis</b> <!-- -->于 <b><time datetime="2022-12-06T11:14:09.000Z">2022/12/6</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/http/http_1"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">« <!-- -->HTTP 1.x</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/http/tcp"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">TCP 协议<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#密码学" class="table-of-contents__link toc-highlight">密码学</a><ul><li><a href="#加密分类" class="table-of-contents__link toc-highlight">加密分类</a></li><li><a href="#密钥交换算法" class="table-of-contents__link toc-highlight">密钥交换算法</a></li></ul></li><li><a href="#https-协议分析" class="table-of-contents__link toc-highlight">HTTPS 协议分析</a><ul><li><a href="#https-加密方式" class="table-of-contents__link toc-highlight">https 加密方式</a></li><li><a href="#证书签发机构ca" class="table-of-contents__link toc-highlight">证书签发机构(CA)</a></li><li><a href="#浏览器如何验证服务器证书的有效性" class="table-of-contents__link toc-highlight">浏览器如何验证服务器证书的有效性</a></li><li><a href="#ssltls协议" class="table-of-contents__link toc-highlight">SSL/TLS协议</a></li><li><a href="#https-ssltls-分析" class="table-of-contents__link toc-highlight">HTTPS SSL/TLS 分析</a></li></ul></li><li><a href="#http-2协议分析" class="table-of-contents__link toc-highlight">HTTP 2协议分析</a><ul><li><a href="#特点" class="table-of-contents__link toc-highlight">特点</a></li><li><a href="#二进制分帧层" class="table-of-contents__link toc-highlight">二进制分帧层</a></li><li><a href="#多路复用" class="table-of-contents__link toc-highlight">多路复用</a></li><li><a href="#服务器推送" class="table-of-contents__link toc-highlight">服务器推送</a></li><li><a href="#伪头字段" class="table-of-contents__link toc-highlight">伪头字段</a></li></ul></li><li><a href="#了解http-3" class="table-of-contents__link toc-highlight">了解HTTP 3</a><ul><li><a href="#http-3特点" class="table-of-contents__link toc-highlight">HTTP 3特点</a></li><li><a href="#队首阻塞问题" class="table-of-contents__link toc-highlight">队首阻塞问题</a></li></ul></li><li><a href="#http与代理" class="table-of-contents__link toc-highlight">HTTP与代理</a><ul><li><a href="#正向代理" class="table-of-contents__link toc-highlight">正向代理</a></li><li><a href="#反向代理" class="table-of-contents__link toc-highlight">反向代理</a></li><li><a href="#反向代理做负载均衡" class="table-of-contents__link toc-highlight">反向代理做负载均衡</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">快速了解</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/performance/page_performance_index">如何监控页面性能指标</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/thinking/design_patterns">设计模式</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/thinking/functional_programming">函数式编程</a></li></ul></div><div class="col footer__col"><div class="footer__title">学习</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/algorithm/">算法</a></li></ul></div><div class="col footer__col"><div class="footer__title">开源贡献</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/open_source/cli/tscli">tscli</a></li><li class="footer__item"><a class="footer__link-item" href="/open_source/github/indexeddb">Indexeddb</a></li><li class="footer__item"><a class="footer__link-item" href="/open_source/github/tinydb_docapi">TinyDB</a></li><li class="footer__item"><a class="footer__link-item" href="/open_source/vscode/Simple-dark">Simple dark</a></li><li class="footer__item"><a href="https://github.com/HondryTravis/xs-docs" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>xs-doc<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/myliang/x-spreadsheet" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>x-spreadsheet<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">联系方式</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/contact">邮箱 | 联系方式</a></li></ul></div><div class="col footer__col"><div class="footer__title">友情链接</div><ul class="footer__items"><li class="footer__item"><a href="https://kalacloud.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>卡拉云低代码工具<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">AGPL-3.0 Licensed | Copyright © 2020-present HondryTravis, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.261a0b30.js"></script>
<script src="/assets/js/main.d8aec2c2.js"></script>
</body>
</html>