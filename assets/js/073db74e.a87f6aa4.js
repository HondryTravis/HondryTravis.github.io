"use strict";(self.webpackChunkhondrytravis_blog=self.webpackChunkhondrytravis_blog||[]).push([[8850],{3905:function(e,n,a){a.d(n,{Zo:function(){return i},kt:function(){return u}});var t=a(7294);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function c(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function o(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?c(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function p(e,n){if(null==e)return{};var a,t,r=function(e,n){if(null==e)return{};var a,t,r={},c=Object.keys(e);for(t=0;t<c.length;t++)a=c[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(t=0;t<c.length;t++)a=c[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=t.createContext({}),s=function(e){var n=t.useContext(l),a=n;return e&&(a="function"==typeof e?e(n):o(o({},n),e)),a},i=function(e){var n=s(e.components);return t.createElement(l.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},k=t.forwardRef((function(e,n){var a=e.components,r=e.mdxType,c=e.originalType,l=e.parentName,i=p(e,["components","mdxType","originalType","parentName"]),k=s(a),u=r,m=k["".concat(l,".").concat(u)]||k[u]||d[u]||c;return a?t.createElement(m,o(o({ref:n},i),{},{components:a})):t.createElement(m,o({ref:n},i))}));function u(e,n){var a=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var c=a.length,o=new Array(c);o[0]=k;var p={};for(var l in n)hasOwnProperty.call(n,l)&&(p[l]=n[l]);p.originalType=e,p.mdxType="string"==typeof e?e:r,o[1]=p;for(var s=2;s<c;s++)o[s]=a[s];return t.createElement.apply(null,o)}return t.createElement.apply(null,a)}k.displayName="MDXCreateElement"},747:function(e,n,a){a.r(n),a.d(n,{frontMatter:function(){return p},contentTitle:function(){return l},metadata:function(){return s},toc:function(){return i},default:function(){return k}});var t=a(3117),r=a(102),c=(a(7294),a(3905)),o=["components"],p={title:"Workspaces | Yarn \u7ba1\u7406"},l=void 0,s={unversionedId:"ci_with_cd/workspace",id:"ci_with_cd/workspace",isDocsHomePage:!1,title:"Workspaces | Yarn \u7ba1\u7406",description:"Yarn \u4ece 1.0 \u7248\u5f00\u59cb\u652f\u6301 Workspace \uff08\u5de5\u4f5c\u533a\uff09\u3002",source:"@site/packages/docs/ci_with_cd/workspace.md",sourceDirName:"ci_with_cd",slug:"/ci_with_cd/workspace",permalink:"/docs/ci_with_cd/workspace",editUrl:"https://github.com/HondryTravis/Blog/tree/master/packages/docs/ci_with_cd/workspace.md",tags:[],version:"current",lastUpdatedBy:"travis",lastUpdatedAt:1670325249,formattedLastUpdatedAt:"2022/12/6",frontMatter:{title:"Workspaces | Yarn \u7ba1\u7406"},sidebar:"docs",previous:{title:"Jenkins | \u81ea\u52a8\u5316\u6784\u5efa",permalink:"/docs/ci_with_cd/jenkins"},next:{title:"husky | \u89c4\u8303\u524d\u7aef git \u64cd\u4f5c",permalink:"/docs/ci_with_cd/husky"}},i=[{value:"\u6839\u76ee\u5f55\u914d\u7f6e",id:"\u6839\u76ee\u5f55\u914d\u7f6e",children:[],level:2},{value:"\u540c\u4e00\u4e2a workspace \u76f8\u4e92\u5f15\u7528\u5b89\u88c5",id:"\u540c\u4e00\u4e2a-workspace-\u76f8\u4e92\u5f15\u7528\u5b89\u88c5",children:[{value:"\u5b89\u88c5\u6839\u76ee\u5f55\u5305",id:"\u5b89\u88c5\u6839\u76ee\u5f55\u5305",children:[],level:3},{value:"\u5b89\u88c5 dependencies",id:"\u5b89\u88c5-dependencies",children:[],level:3},{value:"\u5b89\u88c5 devDependencies",id:"\u5b89\u88c5-devdependencies",children:[],level:3},{value:"\u5220\u9664\u5305",id:"\u5220\u9664\u5305",children:[],level:3},{value:"\u67e5\u770b\u4fe1\u606f",id:"\u67e5\u770b\u4fe1\u606f",children:[],level:3},{value:"\u542f\u52a8",id:"\u542f\u52a8",children:[],level:3},{value:"\u5176\u4ed6",id:"\u5176\u4ed6",children:[],level:3}],level:2},{value:"Q &amp; A \u5730\u5740",id:"q--a-\u5730\u5740",children:[],level:2},{value:"\u53c2\u8003\u8fde\u63a5",id:"\u53c2\u8003\u8fde\u63a5",children:[],level:2}],d={toc:i};function k(e){var n=e.components,a=(0,r.Z)(e,o);return(0,c.kt)("wrapper",(0,t.Z)({},d,a,{components:n,mdxType:"MDXLayout"}),(0,c.kt)("p",null,"Yarn \u4ece 1.0 \u7248\u5f00\u59cb\u652f\u6301 Workspace \uff08\u5de5\u4f5c\u533a\uff09\u3002"),(0,c.kt)("p",null,"Workspace \u80fd\u66f4\u597d\u7684\u7edf\u4e00\u7ba1\u7406\u6709\u591a\u4e2a\u9879\u76ee\u7684\u4ed3\u5e93\uff0c\u65e2\u53ef\u5728\u6bcf\u4e2a\u9879\u76ee\u4e0b\u4f7f\u7528\u72ec\u7acb\u7684 package.json \u7ba1\u7406\u4f9d\u8d56\uff0c\u53c8\u53ef\u4fbf\u5229\u7684\u4eab\u53d7\u4e00\u6761 yarn \u547d\u4ee4\u5b89\u88c5\u6216\u8005\u5347\u7ea7\u6240\u6709\u4f9d\u8d56\u7b49\u3002\u66f4\u91cd\u8981\u7684\u662f\u53ef\u4ee5\u4f7f\u591a\u4e2a\u9879\u76ee\u5171\u4eab\u540c\u4e00\u4e2a node_modules \u76ee\u5f55\uff0c\u63d0\u5347\u5f00\u53d1\u6548\u7387\u548c\u964d\u4f4e\u78c1\u76d8\u7a7a\u95f4\u5360\u7528\u3002\u597d\u5904\u4e0d\u7528\u591a\u8bf4\u4e86\u5427, \u5171\u7528\u4e00\u4e2a node_modules.\u5f53\u7136\u4e5f\u6709\u5f0a\u7aef\uff0c\u521d\u6b21\u5b89\u88c5\u8fc7\u4e8e\u7f13\u6162\uff0c\u8ddf\u968f\u7740\u9879\u76ee\u7684\u5927\u5c0f\u7a0b\u5ea6\uff0c\u53ef\u4ee5\u91c7\u7528 ",(0,c.kt)("a",{parentName:"p",href:"https://github.com/lerna/lerna"},"lerna")," (\u4e0d\u505a\u4ecb\u7ecd\uff0cyarn \u76ee\u524d\u662f\u6700\u4f18\u9009\u62e9\uff0c\u5df2\u8e29\u5751\uff0c\u7b2c\u4e09\u65b9\u4f9d\u8d56\u4f1a\u5b58\u5728\u5197\u4f59\u91cd\u590d, yarn \u66f4\u4e3a\u6e05\u723d\uff0c\u611f\u5174\u8da3\u53ef\u4ee5\u5c1d\u8bd5) \u6784\u5efa\u3002\u5f53\u7136\u6700\u597d\u7684\u65b9\u6848\u8fd8\u662f\u7ed3\u5408\u4f7f\u7528\uff0clerna \u66f4\u65b0\u540e\u4e5f\u652f\u6301 workspace, \u7ed3\u5408\u4f7f\u7528\uff0c\u6548\u679c\u66f4\u4f73"),(0,c.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,c.kt)("div",{parentName:"div",className:"admonition-heading"},(0,c.kt)("h5",{parentName:"div"},(0,c.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,c.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,c.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"\u63d0\u9192")),(0,c.kt)("div",{parentName:"div",className:"admonition-content"},(0,c.kt)("p",{parentName:"div"},"\u7531\u4e8e yarn 1.x \u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4\u4e86\uff0c\u53ef\u4ee5\u53c2\u9605 ",(0,c.kt)("a",{parentName:"p",href:"https://docs.npmjs.com/cli/v7/using-npm/workspaces"},"npm workspaces")))),(0,c.kt)("h2",{id:"\u6839\u76ee\u5f55\u914d\u7f6e"},"\u6839\u76ee\u5f55\u914d\u7f6e"),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"private \u4e0d\u4f5c\u4e3a\u6839\u76ee\u5f55\u53d1\uff0c\u6700\u597d\u662f true",(0,c.kt)("ul",{parentName:"li"},(0,c.kt)("li",{parentName:"ul"},"\u5f53\u7ec4\u4ef6\u5e93\u5f00\u53d1\u5b8c\u6bd5\u540e\uff0c\u8981\u53d1\u5e03\u5230 NPM\u3002\u5de5\u4f5c\u533a\u7684\u6839\u76ee\u5f55\u4e00\u822c\u662f\u811a\u624b\u67b6\uff0c\u4e0d\u9700\u8981\u53d1\u5e03\u3002private \u662f\u4e3a\u4e86\u9632\u6b62\u610f\u5916\u628a\u5185\u5bb9\u66b4\u9732\u51fa\u53bb"))),(0,c.kt)("li",{parentName:"ul"},"workspaces  \u8868\u793a\u5de5\u4f5c\u7a7a\u95f4",(0,c.kt)("ul",{parentName:"li"},(0,c.kt)("li",{parentName:"ul"},"\u4e00\u4e2a\u6570\u7ec4\uff0c\u5b58\u50a8\u8981\u7ba1\u7406\u7684\u6240\u6709\u5305\u7684\u8def\u5f84\uff08\u4e5f\u53ef\u4ee5\u6210\u4e3a\u5de5\u4f5c\u533a workspace\uff09\uff0c\u652f\u6301 ",(0,c.kt)("a",{parentName:"li",href:"https://github.com/isaacs/node-glob"},"Glob \u901a\u914d\u7b26"),"\u3002"),(0,c.kt)("li",{parentName:"ul"},(0,c.kt)("strong",{parentName:"li"},"\u6ce8\u610f"),"\uff1a\u7531\u4e8e\u4f7f\u7528\u901a\u914d\u7b26\uff0c\u5982\u679c\u8fd9\u6837\u4f7f\u7528./packages/*\u5c06\u4f1a\u6709\u95ee\u9898\uff0c\u8be6\u7ec6\u53c2\u8003 ",(0,c.kt)("a",{parentName:"li",href:"https://github.com/isaacs/node-glob#dots"},"Dots"))))),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "name": "@blog/example",\n  "private": true,\n  "version": "1.0.0",\n  "workspaces": [\n    "packages/*"\n  ]\n}\n')),(0,c.kt)("h2",{id:"\u540c\u4e00\u4e2a-workspace-\u76f8\u4e92\u5f15\u7528\u5b89\u88c5"},"\u540c\u4e00\u4e2a workspace \u76f8\u4e92\u5f15\u7528\u5b89\u88c5"),(0,c.kt)("h3",{id:"\u5b89\u88c5\u6839\u76ee\u5f55\u5305"},"\u5b89\u88c5\u6839\u76ee\u5f55\u5305"),(0,c.kt)("ul",null,(0,c.kt)("li",{parentName:"ul"},"-D: \u4f5c\u4e3a\u5f00\u53d1\u4f9d\u8d56\u5b89\u88c5"),(0,c.kt)("li",{parentName:"ul"},"-W: ",(0,c.kt)("inlineCode",{parentName:"li"},"--ignore-workspace-root-check")," \u8868\u793a\u5b89\u88c5\u5230\u5de5\u4f5c\u533a\u7684\u6839\u76ee\u5f55")),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-bash"},"yarn add [package_name] -D -W\nyarn remove [package_name] -W\n")),(0,c.kt)("h3",{id:"\u5b89\u88c5-dependencies"},"\u5b89\u88c5 dependencies"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-bash"},"yarn workspace [package_name] add [package_name]@[version]\n")),(0,c.kt)("h3",{id:"\u5b89\u88c5-devdependencies"},"\u5b89\u88c5 devDependencies"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-bash"},"yarn workspace [package_name] add -D [package_name]@[version]\n")),(0,c.kt)("h3",{id:"\u5220\u9664\u5305"},"\u5220\u9664\u5305"),(0,c.kt)("p",null,"\u5220\u9664\u76f8\u5173\u4e5f\u662f\u7c7b\u4f3c\u7684\uff0c\u4e0d\u7528\u5e26\u6307\u5b9a\u7248\u672c"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-bash"},"yarn workspace [package_name] remove [package_name]\n")),(0,c.kt)("h3",{id:"\u67e5\u770b\u4fe1\u606f"},"\u67e5\u770b\u4fe1\u606f"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-bash"},"yarn workspaces info --json\n")),(0,c.kt)("h3",{id:"\u542f\u52a8"},"\u542f\u52a8"),(0,c.kt)("p",null,(0,c.kt)("strong",{parentName:"p"},"yarn workspaces"),": \u8868\u793a\u6ca1\u4e2a\u9879\u76ee\u4e0b\u6267\u884c"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-bash"},"yarn workspaces run test\n")),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-bash"},'yarn workspaces vx.x.x\n{ "create-subscription": {\n    "location": "packages/create-subscription",\n    "workspaceDependencies": [],\n    "mismatchedWorkspaceDependencies": []\n  },\n  ...\n  "react-noop-renderer": {\n    "location": "packages/react-noop-renderer",\n    "workspaceDependencies": [\n      "react-reconciler"\n    ],\n    "mismatchedWorkspaceDependencies": []\n  },\n  "react-reconciler": {\n    "location": "packages/react-reconciler",\n    "workspaceDependencies": [],\n    "mismatchedWorkspaceDependencies": []\n  }, ... }\n')),(0,c.kt)("h3",{id:"\u5176\u4ed6"},"\u5176\u4ed6"),(0,c.kt)("p",null,"yarn \u7684\u547d\u4ee4\u5927\u90fd\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528"),(0,c.kt)("h2",{id:"q--a-\u5730\u5740"},"Q & A \u5730\u5740"),(0,c.kt)("p",null,(0,c.kt)("a",{parentName:"p",href:"https://github.com/HondryTravis/Blog-example/tree/master/packages/demo2"},"demo2")),(0,c.kt)("p",null,"\u67e5\u770b demo2 \u5e76\u6267\u884c ",(0,c.kt)("inlineCode",{parentName:"p"},"yarn test"),";"),(0,c.kt)("pre",null,(0,c.kt)("code",{parentName:"pre",className:"language-bash"},"# \u63a7\u5236\u53f0\u4f1a\u6253\u5370\u5982\u4e0b\u7ed3\u679c\n\u6211\u662f demo\uff01\n")),(0,c.kt)("h2",{id:"\u53c2\u8003\u8fde\u63a5"},"\u53c2\u8003\u8fde\u63a5"),(0,c.kt)("p",null,(0,c.kt)("a",{parentName:"p",href:"https://classic.yarnpkg.com/en/docs/cli/workspaces"},"Workspaces")),(0,c.kt)("p",null,(0,c.kt)("a",{parentName:"p",href:"https://classic.yarnpkg.com/blog/2017/08/02/introducing-workspaces/"},"Workspaces in Yarn")),(0,c.kt)("p",null,(0,c.kt)("a",{parentName:"p",href:"https://classic.yarnpkg.com/en/docs/workspaces"},"Workspaces")),(0,c.kt)("p",null,(0,c.kt)("a",{parentName:"p",href:"https://blog.csdn.net/u012961419/article/details/108704826"},"Yarn workspaces - \u76ae\u86cb\u5f88\u767d")))}k.isMDXComponent=!0}}]);